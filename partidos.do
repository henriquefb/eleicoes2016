///////////////////////////////////////////////////////////////////////////////
///////////////////////////////// ESCRITO POR /////////////////////////////////
///////////////////////////////// CARLOS GÓES /////////////////////////////////
////////////////////////////////////// E //////////////////////////////////////
//////////////////////////////// RADUAN MEIRA /////////////////////////////////
///////////////////////////////////////////////////////////////////////////////
///////////////////////// INSTITUTO MERCADO POPULAR ///////////////////////////
/////////////////////////// www.mercadopopular.org ////////////////////////////
///////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////
////////////////////////////////// LEIA-ME ////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////

/*

Descrição do projeto

Usa dados do arquivo resultados19962012.txt,
organizado com dados brutos do TSE sobre resultados eleitorais,
para detalhar a distribuicao de prefeituras entre blocos de alianças
eleitorais distintas (tucanos, petistas e outros) e o papel do PMDB nos outros.
 
 */
///////////////////////////////////////////////////////////////////////////////
////////////////////////////////// INTERFACE //////////////////////////////////
//////////// ALTERE OS VALORES DESTA SEÇÃO PARA CUSTOMIZAR A ANÁLISE //////////
///////////////////////////////////////////////////////////////////////////////

// Defina seu diretório de trabalho
	local diretorio = "U:\Research\partidos\basededados"
	
// Grupo tucano
	local azul = "PSDB PFL DEM PPS"

// Grupo petista
	local vermelho = "PT PCdoB PSB PDT PPS PST PGT PL PRONA PR"
 
///////////////////////////////////////////////////////////////////////////////
///////////////////////// CÓDIGO (USUÁRIOS AVANÇADOS) /////////////////////////
///////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////
/////////////////////////// 1. ORGANIZAÇÃO DO ESPAÇO //////////////////////////
///////////////////////////////////////////////////////////////////////////////
 
capture log close 										// closes any open logs
clear 													// clears the memory
clear matrix 											// clears matrix memory
clear mata 												// clears mata memory
cd "`diretorio'" 
set more off  																					
log using dados.log, replace  	

///////////////////////////////////////////////////////////////////////////////
/////////////////////////// 2. PREPARAÇÃO DOS DADOS ///////////////////////////
///////////////////////////////////////////////////////////////////////////////


	import delimited resultados19962012.txt, clear
	sort ano estado municipio
	replace partido = "PCdoB" if partido == "PC do B"
	replace partido = "PTdoB" if partido == "PT do B"
	
///////////////////////////////////////////////////////////////////////////////
//////////////////// 3. CALCULAR REPRESENTAÇÃO DE ALIANÇAS ////////////////////
///////////////////////////////////////////////////////////////////////////////

	
	// tucanos
	
	generate tucanos = 0
	
	foreach x in `azul'  {
		if (partido == "PPS") {
			replace tucanos = 1 if partido == "`x'" & ano >= 2002
		}
		else {
			replace tucanos = 1 if partido == "`x'"
		}
	}
	
	// petistas
	
	generate petistas = 0
	
	foreach x in `vermelho'  {
		if (partido == "PPS") {
			replace petistas = 1 if partido == "`x'" & ano <= 2002
		}
		else {
			replace petistas = 1 if partido == "`x'"
		}
	}
	
	// outros
	
	generate outros = 0
	replace outros = 1 if petistas == 0 & tucanos == 0 

	/// PMDB
	
	gen pmdb = 0
	replace pmdb = 1 if partido == "PMDB"

	/// outros sem PMDB
	
	gen outros_n = 0
	replace outros_n = 1 if outros == 1 & partido != "PMDB"
	
	/// resultado por ano
	
	forval x = 1996(4)2012  {
		di "Ano: `x'"
		sum tucanos petistas outros pmdb outros_n if ano == `x'
	}	
